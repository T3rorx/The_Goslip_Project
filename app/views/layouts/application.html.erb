<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "The Goslip Project" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body data-theme="dark">
    <div class="gp-container">
      <nav class="gp-navbar gp-fade-1">
        <div class="gp-brand">
          <span class="gp-brand__logo" aria-hidden="true"></span>
          <p class="gp-brand__name gp-mb-0">The Gossip Project</p>
        </div>
        <div class="gp-nav-links">
          <button id="theme-toggle" class="gp-btn gp-btn--ghost" type="button" aria-pressed="false" aria-label="Basculer le th√®me">
            ‚òÄÔ∏è Mode jour
          </button>
          <%= link_to "Accueil", root_path, class: "gp-btn gp-btn--primary" %>
          <%= link_to "Team", pages_team_path, class: "gp-btn" %>
          <%= link_to "Contact", contact_path, class: "gp-btn gp-btn--ghost" %>
        </div>
      </nav>

      <main class="gp-main gp-fade-2">
        <%= yield %>
      </main>

      <footer class="gp-footer gp-fade-3">
        <span>¬© <%= Time.current.year %> Goslip Project</span>
        <span class="sep">‚Ä¢</span>
        <span>Powered by FlowTech LAB vibes</span>
      </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
      (() => {
        const root = document.body;
        const storageKey = "gossip-theme";
        const toggle = document.getElementById("theme-toggle");
        if (!toggle) return;

        const saved = localStorage.getItem(storageKey);
        const initial = saved === "dark" || saved === "light" ? saved : root.dataset.theme || "dark";
        applyTheme(initial);

        toggle.addEventListener("click", () => {
          const next = root.dataset.theme === "dark" ? "light" : "dark";
          applyTheme(next);
          localStorage.setItem(storageKey, next);
        });

        function applyTheme(mode) {
          root.dataset.theme = mode;
          const isDark = mode === "dark";
          toggle.setAttribute("aria-pressed", String(isDark));
          toggle.textContent = isDark ? "üåô Mode nuit" : "‚òÄÔ∏è Mode jour";
          toggle.classList.remove("gp-btn--primary", "gp-btn--ghost");
          toggle.classList.add(isDark ? "gp-btn--ghost" : "gp-btn--primary");
        }
      })();
    </script>
  </body>
</html>
